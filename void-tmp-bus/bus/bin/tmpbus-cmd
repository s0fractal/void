#!/usr/bin/env node

import { CommandClient } from '../dist/commands.js';

const method = process.argv[2];
const params = process.argv[3] ? JSON.parse(process.argv[3]) : undefined;

if (!method) {
  console.error('Usage: tmpbus-cmd <method> [params]');
  console.error('Methods: health, flush, rotate, stats, lease');
  process.exit(1);
}

const client = new CommandClient();

client.call(method, params)
  .then(result => {
    console.log(JSON.stringify(result, null, 2));
    process.exit(0);
  })
  .catch(error => {
    console.error('Error:', error.message);
    process.exit(1);
  });